/**
 * angular-ionic-datepicker
 * @version v0.0.1
 * @link https://github.com/sidigdoyo/angular-ionic-datepicker
 * @license MIT
 * @author Sidigdoyo Pribadi <sidigdoyo@gmail.com>
 */


!function(t,e,n){var a=function(){var t=this,e=function(){};e.$inject=[],t.$get=e};a.$inject=[];var r=function(t,e){var n,a,r=new Date,o=function(t,e){for(var r=new Date(e,t,1),o=[];0!==r.getDay();)r.setDate(r.getDate()-1),o.unshift(new Date(r));for(r.getMonth()!==t&&(r=new Date(e,t,1));r.getMonth()===t;)1===r.getDate()?n=new Date(r):a=new Date(r),o.push(new Date(r)),r.setDate(r.getDate()+1);for(;0!==r.getDay();)o.push(new Date(r)),r.setDate(r.getDate()+1);return o},c=function(t){var e=t.getMonth(),n=t.getFullYear();return e+1===12?(e=0,n+=1):e+=1,t.setMonth(e),t.setFullYear(n),t},i=function(t){var e=t.getMonth(),n=t.getFullYear();return e-1===-1?(e=11,n-=1):e-=1,t.setMonth(e),t.setFullYear(n),t};return{getDaysInMonth:o,today:function(){return new Date(r.getFullYear(),r.getMonth(),r.getDate())},getDays:function(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},getCurrent:function(){return{min:n,max:a}},getMonths:function(){for(var t=0,n=[];12>t;)n.push(e.moment().month(t++).format("MMMM"));return n},getYears:function(t){var e=new Date,n=e.getFullYear();t&&(n=t);for(var a=[],r=n-6;n+6>r;r++)a.push(r);return a},nextMonth:c,prevMonth:i}};r.$inject=["$ionDatepicker","$window"],ionDatepickerCtrl=function(t,e,n,a){var r=this;r.hasMinValue=!1,r.minDateValue&&(r.minDateValue=new Date(r.minDateValue.getFullYear(),r.minDateValue.getMonth(),r.minDateValue.getDate()),r.hasMinValue=!0),r.today=a.today(),r.weeks=a.getDays(),r.currentDate=a.today(),r.daysInMonth=a.getDaysInMonth(r.today.getMonth(),r.today.getFullYear()),r.currentMonth=a.getCurrent(),r.nextMonth=function(){r.currentDate=a.nextMonth(r.currentDate),r.daysInMonth=a.getDaysInMonth(r.currentDate.getMonth(),r.currentDate.getFullYear()),r.currentMonth=a.getCurrent()},r.prevMonth=function(){r.currentDate=a.prevMonth(r.currentDate),r.daysInMonth=a.getDaysInMonth(r.currentDate.getMonth(),r.currentDate.getFullYear()),r.currentMonth=a.getCurrent()},r.showPopup=function(){r.popup=e.show({template:"<div class='calendar-title'><div class='title'><span ng-click='ctrl.showPopupMonth()'>{{ctrl.currentDate | date : 'MMMM'}}</span> <span ng-click='ctrl.showPopupYear()'>{{ctrl.currentDate | date : 'yyyy'}}</span></div><a ng-click='ctrl.prevMonth()' class='button button-clear button-icon prev'><i class='ion-chevron-left'></i></a><a ng-click='ctrl.nextMonth()' class='button button-clear button-icon next'><i class='ion-chevron-right'></i></a></div><div class='calendar-box'><div class='calendar-weeks' ng-repeat='day in ctrl.weeks'>{{day}}</div><div class='calendar-day' ng-repeat='day in ctrl.daysInMonth' ng-class='{\"today\": day.getTime() == ctrl.today.getTime(), \"selected\": day.getTime() == ctrl.model.getTime(), \"prev-month\": day.getTime() < ctrl.currentMonth.min.getTime(), \"next-month\": day.getTime() > ctrl.currentMonth.max.getTime(), \"min-value\": ctrl.hasMinValue && ctrl.minDateValue.getTime() > day.getTime()}' ng-click='ctrl.select(day)'>{{day.getDate()}}</div></div>",cssClass:"datepicker",scope:t.$new()})},r.setMonth=function(t){r.currentDate.setMonth(t),r.daysInMonth=a.getDaysInMonth(r.currentDate.getMonth(),r.currentDate.getFullYear()),r.currentMonth=a.getCurrent(),r.popupMonth.close()},r.showPopupMonth=function(){r.months=a.getMonths(),r.popupMonth=e.show({template:"<div class='calendar-month-box'><div class='calendar-month' ng-repeat='month in ctrl.months track by $index' ng-click='ctrl.setMonth($index)'>{{month}}</div></div>",cssClass:"datepicker-month",scope:t.$new(),buttons:[{text:"Cancel"}]})},r.setYear=function(t){r.currentDate.setFullYear(t),r.daysInMonth=a.getDaysInMonth(r.currentDate.getMonth(),r.currentDate.getFullYear()),r.currentMonth=a.getCurrent(),r.popupYear.close()},r.setYears=function(t){r.years=a.getYears(t)},r.showPopupYear=function(){r.years=a.getYears(),r.popupYear=e.show({template:"<div class='calendar-title'><div class='title'>{{ctrl.currentDate.getFullYear()}}</div><a ng-click='ctrl.setYears(ctrl.years[0] - 6)' class='button button-clear button-icon prev'><i class='ion-chevron-left'></i></a><a ng-click='ctrl.setYears(ctrl.years[11] + 7)' class='button button-clear button-icon next'><i class='ion-chevron-right'></i></a></div><div class='calendar-year-box'><div class='calendar-year' ng-repeat='year in ctrl.years track by $index' ng-class='{\"current-year\": year === ctrl.currentDate.getFullYear()}' ng-click='ctrl.setYear(year)'>{{year}}</div></div>",cssClass:"datepicker-year",scope:t.$new(),buttons:[{text:"Cancel"}]})},r.closePopup=function(){r.popup.close()},r.select=function(t){(!r.hasMinValue||t.getTime()>=r.minDateValue.getTime())&&(r.model=t,r.closePopup())}},ionDatepickerCtrl.$inject=["$scope","$ionicPopup","$filter","ionDatepickerService"],ionDatepickerLink=function(t,e,n,a){var r=function(){a.showPopup()};e.bind("click",r),a.hasMinValue&&t.$watch("ctrl.minDateValue",function(t,e){t&&t.getTime()>a.model&&delete a.model})};var o=function(){return{restrict:"A",bindToController:{model:"=ngModel",minDateValue:"="},scope:{},controllerAs:"ctrl",controller:ionDatepickerCtrl,link:ionDatepickerLink}};o.$inject=[];var c=function(t){return{require:"^ngModel",restrict:"A",link:function(e,n,a,r){var o=t.moment,c=a.ionDateFormat;a.$observe("ionDateFormat",function(t){c!=t&&r.$modelValue&&(c=t,r.$modelValue=new Date(r.$setViewValue))}),r.$formatters.unshift(function(t){if(!c||!t)return"";var e=o(new Date(t)).format(c);return e}),r.$parsers.unshift(function(t){var e=o(t,c);return e&&e.isValid()&&e.year()>1950?e.toDate():""})}}};c.$inject=["$window"],e.module("ionic.datepicker",["ionic"]).provider("$ionDatepicker",a).directive("ionDatepicker",o).factory("ionDatepickerService",r).directive("ionDateFormat",c)}(window,window.angular);