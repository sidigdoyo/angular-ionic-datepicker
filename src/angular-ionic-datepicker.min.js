/**
 * angular-ionic-datepicker
 * @version v0.0.1
 * @link https://github.com/sidigdoyo/angular-ionic-datepicker
 * @license MIT
 * @author Sidigdoyo Pribadi <sidigdoyo@gmail.com>
 */


!function(t,e,n){var r=function(){var t=this,e=function(){};e.$inject=[],t.$get=e};r.$inject=[];var a=function(t,e){var n,r,a=new Date,o=function(t,e){for(var a=new Date(e,t,1),o=[];0!==a.getDay();)a.setDate(a.getDate()-1),o.unshift(new Date(a));for(a.getMonth()!==t&&(a=new Date(e,t,1));a.getMonth()===t;)1===a.getDate()?n=new Date(a):r=new Date(a),o.push(new Date(a)),a.setDate(a.getDate()+1);for(;0!==a.getDay();)o.push(new Date(a)),a.setDate(a.getDate()+1);return o},c=function(t){var e=t.getMonth(),n=t.getFullYear();return e+1===12?(e=0,n+=1):e+=1,t.setMonth(e),t.setFullYear(n),t},i=function(t){var e=t.getMonth(),n=t.getFullYear();return e-1===-1?(e=11,n-=1):e-=1,t.setMonth(e),t.setFullYear(n),t};return{getDaysInMonth:o,today:function(){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},getDays:function(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},getCurrent:function(){return{min:n,max:r}},getMonths:function(){for(var t=0,n=[];12>t;)n.push(e.moment().month(t++).format("MMMM"));return n},getYears:function(t){var e=new Date,n=e.getFullYear();t&&(n=t);for(var r=[],a=n-6;n+6>a;a++)r.push(a);return r},nextMonth:c,prevMonth:i}};a.$inject=["$ionDatepicker","$window"],ionDatepickerCtrl=function(t,n,r,a){var o=this;o.hasMinValue=!1,o.minDateValue&&(o.minDateValue=new Date(o.minDateValue.getFullYear(),o.minDateValue.getMonth(),o.minDateValue.getDate()),o.hasMinValue=!0),o.today=a.today(),o.weeks=a.getDays(),o.currentDate=a.today(),o.model&&(o.currentDate=e.copy(o.model)),o.daysInMonth=a.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=a.getCurrent(),o.nextMonth=function(){o.currentDate=a.nextMonth(o.currentDate),o.daysInMonth=a.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=a.getCurrent()},o.prevMonth=function(){o.currentDate=a.prevMonth(o.currentDate),o.daysInMonth=a.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=a.getCurrent()},o.prevYear=function(){o.currentDate.setFullYear(o.currentDate.getFullYear()-1),o.daysInMonth=a.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=a.getCurrent()},o.nextYear=function(){o.currentDate.setFullYear(o.currentDate.getFullYear()+1),o.daysInMonth=a.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=a.getCurrent()},o.showPopup=function(){o.popup=n.show({template:"<div class='calendar-title'><div class='title'><div class='month-select' ><div ng-click='ctrl.showPopupMonth()'>{{ctrl.currentDate | date : 'MMMM'}}</div><a ng-click='ctrl.prevMonth()' class='button button-clear button-icon prev'><i class='ion-chevron-left'></i></a><a ng-click='ctrl.nextMonth()' class='button button-clear button-icon next'><i class='ion-chevron-right'></i></a></div><div class='year-select'><div ng-click='ctrl.showPopupYear()'>{{ctrl.currentDate | date : 'yyyy'}}</div><a ng-click='ctrl.prevYear()' class='button button-clear button-icon prev'><i class='ion-chevron-left'></i></a><a ng-click='ctrl.nextYear()' class='button button-clear button-icon next'><i class='ion-chevron-right'></i></a></div></div></div><div class='calendar-box'><div class='calendar-weeks' ng-repeat='day in ctrl.weeks'>{{day}}</div><div class='calendar-day' ng-repeat='day in ctrl.daysInMonth' ng-class='{\"today\": day.getTime() == ctrl.today.getTime(), \"selected\": day.getTime() == ctrl.model.getTime(), \"prev-month\": day.getTime() < ctrl.currentMonth.min.getTime(), \"next-month\": day.getTime() > ctrl.currentMonth.max.getTime(), \"min-value\": ctrl.hasMinValue && ctrl.minDateValue.getTime() > day.getTime()}' ng-click='ctrl.select(day)'>{{day.getDate()}}</div></div>",cssClass:"datepicker",scope:t.$new()})},o.setMonth=function(t){o.currentDate.setMonth(t),o.daysInMonth=a.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=a.getCurrent(),o.popupMonth.close()},o.showPopupMonth=function(){o.months=a.getMonths(),o.popupMonth=n.show({template:"<div class='calendar-month-box'><div class='calendar-month' ng-repeat='month in ctrl.months track by $index' ng-click='ctrl.setMonth($index)'>{{month}}</div></div>",cssClass:"datepicker-month",scope:t.$new(),buttons:[{text:"Cancel"}]})},o.setYear=function(t){o.currentDate.setFullYear(t),o.daysInMonth=a.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=a.getCurrent(),o.popupYear.close()},o.setYears=function(t){o.years=a.getYears(t)},o.showPopupYear=function(){o.years=a.getYears(),o.popupYear=n.show({template:"<div class='calendar-title'><div class='title'>{{ctrl.currentDate.getFullYear()}}</div><a ng-click='ctrl.setYears(ctrl.years[0] - 6)' class='button button-clear button-icon prev'><i class='ion-chevron-left'></i></a><a ng-click='ctrl.setYears(ctrl.years[11] + 7)' class='button button-clear button-icon next'><i class='ion-chevron-right'></i></a></div><div class='calendar-year-box'><div class='calendar-year' ng-repeat='year in ctrl.years track by $index' ng-class='{\"current-year\": year === ctrl.currentDate.getFullYear()}' ng-click='ctrl.setYear(year)'>{{year}}</div></div>",cssClass:"datepicker-year",scope:t.$new(),buttons:[{text:"Cancel"}]})},o.closePopup=function(){o.popup.close()},o.select=function(t){(!o.hasMinValue||t.getTime()>=o.minDateValue.getTime())&&(o.model=t,o.closePopup())}},ionDatepickerCtrl.$inject=["$scope","$ionicPopup","$filter","ionDatepickerService"],ionDatepickerLink=function(t,e,n,r){var a=function(){r.showPopup()};e.bind("click",a),r.hasMinValue&&t.$watch("ctrl.minDateValue",function(t,e){t&&t.getTime()>r.model&&delete r.model})};var o=function(){return{restrict:"A",bindToController:{model:"=ngModel",minDateValue:"="},scope:{},controllerAs:"ctrl",controller:ionDatepickerCtrl,link:ionDatepickerLink}};o.$inject=[];var c=function(t){return{require:"^ngModel",restrict:"A",link:function(e,n,r,a){var o=t.moment,c=r.ionDateFormat;r.$observe("ionDateFormat",function(t){c!=t&&a.$modelValue&&(c=t,a.$modelValue=new Date(a.$setViewValue))}),a.$formatters.unshift(function(t){if(!c||!t)return"";var e=o(new Date(t)).format(c);return e}),a.$parsers.unshift(function(t){var e=o(t,c);return e&&e.isValid()&&e.year()>1950?e.toDate():""})}}};c.$inject=["$window"],e.module("ionic.datepicker",["ionic"]).provider("$ionDatepicker",r).directive("ionDatepicker",o).factory("ionDatepickerService",a).directive("ionDateFormat",c)}(window,window.angular);