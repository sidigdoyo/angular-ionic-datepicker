/**
 * angular-ionic-datepicker
 * @version v0.0.1
 * @link https://github.com/sidigdoyo/angular-ionic-datepicker
 * @license MIT
 * @author Sidigdoyo Pribadi <sidigdoyo@gmail.com>
 */


!function(e,t,n){var a=function(){var e=this,t=function(){};t.$inject=[],e.$get=t};a.$inject=[];var r=function(e,t){var n,a,r=new Date,o=function(e,t){for(var r=new Date(t,e,1),o=[];0!==r.getDay();)r.setDate(r.getDate()-1),o.unshift(new Date(r));for(r.getMonth()!==e&&(r=new Date(t,e,1));r.getMonth()===e;)1===r.getDate()?n=new Date(r):a=new Date(r),o.push(new Date(r)),r.setDate(r.getDate()+1);for(;0!==r.getDay();)o.push(new Date(r)),r.setDate(r.getDate()+1);return o},c=function(e){var t=e.getMonth(),n=e.getFullYear();return t+1===12?(t=0,n+=1):t+=1,e.setMonth(t),e.setFullYear(n),e},i=function(e){var t=e.getMonth(),n=e.getFullYear();return t-1===-1?(t=11,n-=1):t-=1,e.setMonth(t),e.setFullYear(n),e};return{getDaysInMonth:o,today:function(){return new Date(r.getFullYear(),r.getMonth(),r.getDate())},getDays:function(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},getCurrent:function(){return{min:n,max:a}},getMonths:function(){for(var e=0,n=[];12>e;)n.push(t.moment().month(e++).format("MMMM"));return n},getYears:function(e){var t=new Date,n=t.getFullYear();e&&(n=e);for(var a=[],r=n-6;n+6>r;r++)a.push(r);return a},nextMonth:c,prevMonth:i}};r.$inject=["$ionDatepicker","$window"],ionDatepickerCtrl=function(e,n,a,r){var o=this;o.hasMinValue=!1,o.minDateValue&&(o.minDateValue=new Date(o.minDateValue.getFullYear(),o.minDateValue.getMonth(),o.minDateValue.getDate()),o.hasMinValue=!0),o.today=r.today(),o.weeks=r.getDays(),o.currentDate=r.today(),o.model&&(o.currentDate=t.copy(o.model)),o.daysInMonth=r.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=r.getCurrent(),o.nextMonth=function(){o.currentDate=r.nextMonth(o.currentDate),o.daysInMonth=r.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=r.getCurrent()},o.prevMonth=function(){o.currentDate=r.prevMonth(o.currentDate),o.daysInMonth=r.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=r.getCurrent()},o.showPopup=function(){o.popup=n.show({template:"<div class='calendar-title'><div class='title'><span ng-click='ctrl.showPopupMonth()'>{{ctrl.currentDate | date : 'MMMM'}}</span> <span ng-click='ctrl.showPopupYear()'>{{ctrl.currentDate | date : 'yyyy'}}</span></div><a ng-click='ctrl.prevMonth()' class='button button-clear button-icon prev'><i class='ion-chevron-left'></i></a><a ng-click='ctrl.nextMonth()' class='button button-clear button-icon next'><i class='ion-chevron-right'></i></a></div><div class='calendar-box'><div class='calendar-weeks' ng-repeat='day in ctrl.weeks'>{{day}}</div><div class='calendar-day' ng-repeat='day in ctrl.daysInMonth' ng-class='{\"today\": day.getTime() == ctrl.today.getTime(), \"selected\": day.getTime() == ctrl.model.getTime(), \"prev-month\": day.getTime() < ctrl.currentMonth.min.getTime(), \"next-month\": day.getTime() > ctrl.currentMonth.max.getTime(), \"min-value\": ctrl.hasMinValue && ctrl.minDateValue.getTime() > day.getTime()}' ng-click='ctrl.select(day)'>{{day.getDate()}}</div></div>",cssClass:"datepicker",scope:e.$new()})},o.setMonth=function(e){o.currentDate.setMonth(e),o.daysInMonth=r.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=r.getCurrent(),o.popupMonth.close()},o.showPopupMonth=function(){o.months=r.getMonths(),o.popupMonth=n.show({template:"<div class='calendar-month-box'><div class='calendar-month' ng-repeat='month in ctrl.months track by $index' ng-click='ctrl.setMonth($index)'>{{month}}</div></div>",cssClass:"datepicker-month",scope:e.$new(),buttons:[{text:"Cancel"}]})},o.setYear=function(e){o.currentDate.setFullYear(e),o.daysInMonth=r.getDaysInMonth(o.currentDate.getMonth(),o.currentDate.getFullYear()),o.currentMonth=r.getCurrent(),o.popupYear.close()},o.setYears=function(e){o.years=r.getYears(e)},o.showPopupYear=function(){o.years=r.getYears(),o.popupYear=n.show({template:"<div class='calendar-title'><div class='title'>{{ctrl.currentDate.getFullYear()}}</div><a ng-click='ctrl.setYears(ctrl.years[0] - 6)' class='button button-clear button-icon prev'><i class='ion-chevron-left'></i></a><a ng-click='ctrl.setYears(ctrl.years[11] + 7)' class='button button-clear button-icon next'><i class='ion-chevron-right'></i></a></div><div class='calendar-year-box'><div class='calendar-year' ng-repeat='year in ctrl.years track by $index' ng-class='{\"current-year\": year === ctrl.currentDate.getFullYear()}' ng-click='ctrl.setYear(year)'>{{year}}</div></div>",cssClass:"datepicker-year",scope:e.$new(),buttons:[{text:"Cancel"}]})},o.closePopup=function(){o.popup.close()},o.select=function(e){(!o.hasMinValue||e.getTime()>=o.minDateValue.getTime())&&(o.model=e,o.closePopup())}},ionDatepickerCtrl.$inject=["$scope","$ionicPopup","$filter","ionDatepickerService"],ionDatepickerLink=function(e,t,n,a){var r=function(){a.showPopup()};t.bind("click",r),a.hasMinValue&&e.$watch("ctrl.minDateValue",function(e,t){e&&e.getTime()>a.model&&delete a.model})};var o=function(){return{restrict:"A",bindToController:{model:"=ngModel",minDateValue:"="},scope:{},controllerAs:"ctrl",controller:ionDatepickerCtrl,link:ionDatepickerLink}};o.$inject=[];var c=function(e){return{require:"^ngModel",restrict:"A",link:function(t,n,a,r){var o=e.moment,c=a.ionDateFormat;a.$observe("ionDateFormat",function(e){c!=e&&r.$modelValue&&(c=e,r.$modelValue=new Date(r.$setViewValue))}),r.$formatters.unshift(function(e){if(!c||!e)return"";var t=o(new Date(e)).format(c);return t}),r.$parsers.unshift(function(e){var t=o(e,c);return t&&t.isValid()&&t.year()>1950?t.toDate():""})}}};c.$inject=["$window"],t.module("ionic.datepicker",["ionic"]).provider("$ionDatepicker",a).directive("ionDatepicker",o).factory("ionDatepickerService",r).directive("ionDateFormat",c)}(window,window.angular);